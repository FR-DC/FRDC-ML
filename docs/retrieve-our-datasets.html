<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-06-26T19:20:44.3061346"><title>Retrieve our Datasets | Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"prerequisites","level":0,"title":"Prerequisites","anchor":"#prerequisites"},{"id":"retrieve-the-data","level":0,"title":"Retrieve the Data","anchor":"#retrieve-the-data"},{"id":"iterate-through-the-data","level":0,"title":"Iterate through the Data","anchor":"#iterate-through-the-data"},{"id":"using-with-pytorch-s-dataloader","level":0,"title":"Using with PyTorch\u0027s DataLoader","anchor":"#using-with-pytorch-s-dataloader"},{"id":"plot-the-data-optional","level":0,"title":"Plot the Data (Optional)","anchor":"#plot-the-data-optional"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Retrieve our Datasets | Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/d/0.1.2/retrieve-our-datasets.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Retrieve our Datasets | Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/d/0.1.2/retrieve-our-datasets.html#webpage",
    "url": "writerside-documentation/d/0.1.2/retrieve-our-datasets.html",
    "name": "Retrieve our Datasets | Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/d/#website",
    "url": "writerside-documentation/d/",
    "name": "Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="Retrieve-our-Datasets" data-main-title="Retrieve our Datasets" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Tutorials"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Documentation 0.1.2 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Retrieve-our-Datasets" id="Retrieve-our-Datasets.md">Retrieve our Datasets</h1><div class="micro-format" data-content="{&quot;microFormat&quot;:[&quot;\u003cp id\u003d\&quot;xdg6ik_503\&quot;\u003eA tutorial to retrieve our datasets\u003c/p\u003e&quot;]}"></div><p id="xdg6ik_441">In this tutorial, we'll learn how to :</p><ul class="list _bullet" id="xdg6ik_442"><li class="list__item" id="xdg6ik_443"><p>Retrieve FRDC's Datasets</p></li><li class="list__item" id="xdg6ik_444"><p>How to inspect the data</p></li><li class="list__item" id="xdg6ik_445"><p>How to integrate it with PyTorch's DataLoader</p></li><li class="list__item" id="xdg6ik_446"><p>How to visualize the data</p></li></ul><section class="chapter"><h2 id="prerequisites" data-toc="prerequisites">Prerequisites</h2><ul class="list _bullet" id="xdg6ik_447"><li class="list__item" id="xdg6ik_448"><p>New here? <a href="getting-started.html" id="xdg6ik_449" data-tooltip="Want to use a Dev Container? See Get Started with Dev Containers">Get Started</a>.</p></li><li class="list__item" id="xdg6ik_450"><p>Setup the Google Cloud Authorization to download the data.</p></li></ul></section><section class="chapter"><h2 id="retrieve-the-data" data-toc="retrieve-the-data">Retrieve the Data</h2><p id="xdg6ik_451">To retrieve the data, use <a href="load-dataset.html" id="xdg6ik_452" data-tooltip="You need to Set-Up Google Cloud with the appropriate permissions to use this library.">FRDCDatasetPreset</a>. This module presets to load explicitly known datasets.</p><p id="xdg6ik_453">For example:</p><div class="code-block" data-lang="python">
from frdc.load.preset import FRDCDatasetPreset

ds = FRDCDatasetPreset.chestnut_20201218()
for x, y in ds:
    print(x.shape, y)
</div><p id="xdg6ik_455">You should get something like this:</p><div class="code-block" data-lang="none">
(831, 700, 8) Falcataria Moluccana
(540, 536, 8) Ficus Variegata
(457, 660, 8) Bridelia Sp.
...
</div><ul class="list _bullet" id="xdg6ik_457"><li class="list__item" id="xdg6ik_458"><p><code class="code" id="xdg6ik_459">x</code> is a <code class="code" id="xdg6ik_460">torch.Tensor</code></p></li><li class="list__item" id="xdg6ik_461"><p><code class="code" id="xdg6ik_462">y</code> is a <code class="code" id="xdg6ik_463">str</code>.</p></li></ul><aside class="prompt" data-type="warning" data-title="" id="xdg6ik_464"><p id="xdg6ik_465"><a href="load-dataset.html#i-can-t-find-a-dataset" id="xdg6ik_466" data-tooltip="Some datasets, especially new ones may be unregistered and you must specify the exact site / date / version of it.">What if I can't find a preset dataset?</a></p></aside></section><section class="chapter"><h2 id="iterate-through-the-data" data-toc="iterate-through-the-data">Iterate through the Data</h2><p id="xdg6ik_467">The dataset, when you load it, will be automatically segmented by bounds. Therefore, if you want to simply loop through the segments and labels, you can treat the dataset as an iterable.</p><div class="code-block" data-lang="python">
from frdc.load.preset import FRDCDatasetPreset

ds = FRDCDatasetPreset.chestnut_20201218()
for x, y in ds:
    print(x.shape, y)
</div><p id="xdg6ik_469">If you just want the segments or targets separately, use <code class="code" id="xdg6ik_470">.ar_segments</code> and <code class="code" id="xdg6ik_471">.targets</code> respectively.</p><div class="code-block" data-lang="python">
from frdc.load.preset import FRDCDatasetPreset

ds = FRDCDatasetPreset.chestnut_20201218()
for x in ds.ar_segments:
    print(x.shape)

for y in ds.targets:
    print(y)
</div><p id="xdg6ik_473">If you want the entire image, use <code class="code" id="xdg6ik_474">.ar</code>.</p><div class="code-block" data-lang="python">
from frdc.load.preset import FRDCDatasetPreset

ds = FRDCDatasetPreset.chestnut_20201218()
ar = ds.ar
</div><p id="xdg6ik_476">Finally, inspect the order of the bands through the <code class="code" id="xdg6ik_477">band_order</code> attribute.</p><div class="code-block" data-lang="python">
from frdc.load.preset import FRDCDatasetPreset

ds = FRDCDatasetPreset.chestnut_20201218()
ds.band_order
</div><div class="code-block" data-lang="bash">
&gt; ['WB', 'WG', 'WR', 'NB', 'NG', 'NR', 'RE', 'NIR']
</div></section><section class="chapter"><h2 id="using-with-pytorch-s-dataloader" data-toc="using-with-pytorch-s-dataloader">Using with PyTorch's DataLoader</h2><p id="xdg6ik_480">Every <code class="code" id="xdg6ik_481">FRDCDataset</code> is a <code class="code" id="xdg6ik_482">Dataset</code> object, so you can use it with PyTorch's <code class="code" id="xdg6ik_483">DataLoader</code>. This allows you to retrieve by batches!</p><div class="code-block" data-lang="python">
from torch.utils.data import DataLoader
from torchvision.transforms.v2 import CenterCrop, Compose, Resize, ToImage

from frdc.load.preset import FRDCDatasetPreset

ds = FRDCDatasetPreset.chestnut_20201218(
    use_legacy_bounds=True,
    transform=Compose([ToImage(), Resize(100), CenterCrop(100)]),
)
dl = DataLoader(ds, batch_size=4, shuffle=True)

for x, y in dl:
    print(x.shape, y)
</div><p id="xdg6ik_485">Which should output</p><div class="code-block" data-lang="bash">
torch.Size([4, 8, 100, 100]) ('Falcataria Moluccana', ...)
torch.Size([4, 8, 100, 100]) ('Clausena Excavata', ...)
torch.Size([4, 8, 100, 100]) ('Clausena Excavata', ...)
...
</div><aside class="prompt" data-type="warning" data-title="" id="xdg6ik_487"><p id="xdg6ik_488"><span class="control" id="xdg6ik_489">RuntimeError: stack expects each tensor to be equal size</span>: The reason for this error is that <code class="code" id="xdg6ik_490">DataLoader</code> expects equal dimensions (image height and width) for all images. To fix this, you can use <code class="code" id="xdg6ik_491">torchvision.transforms.v2.Resize</code> to resize the images to a fixed size in the above example.</p></aside></section><section class="chapter"><div class="collapse"><div class="collapse__title"><h2 id="plot-the-data-optional" data-toc="plot-the-data-optional">Plot the Data (Optional)</h2></div><div class="collapse__content"><p id="xdg6ik_492">We can then use these data to plot out the first tree segment.</p><div class="code-block" data-lang="python">
import matplotlib.pyplot as plt

from frdc.load.preset import FRDCDatasetPreset
from frdc.preprocess.scale import scale_0_1_per_band

ds = FRDCDatasetPreset.chestnut_20201218()
segment_0_bgr = ds.ar_segments[0]
segment_0_rgb = segment_0_bgr[..., [2, 1, 0]]
segment_0_rgb_scaled = scale_0_1_per_band(segment_0_rgb)

plt.imshow(segment_0_rgb_scaled)
plt.title(f&quot;Tree {ds.targets[0]}&quot;)
plt.show()
</div><p id="xdg6ik_494">See also: <a href="preprocessing-scale.html" id="xdg6ik_495" data-tooltip="The static scaling has a default config, which was inferred by our capturing device.">preprocessing.scale.scale_0_1_per_band</a></p><p id="xdg6ik_496">MatPlotLib cannot show the data correctly as-is, so we need to</p><ul class="list _bullet" id="xdg6ik_497"><li class="list__item" id="xdg6ik_498"><p>Convert the data from BGR to RGB</p></li><li class="list__item" id="xdg6ik_499"><p>Scale the data to 0-1 per band</p></li></ul><aside class="prompt" data-type="note" data-title="" id="xdg6ik_500"><p id="xdg6ik_501">Remember that the library returns the band <code class="code" id="xdg6ik_502">order</code>? This is useful in debugging the data. If we had shown it in BGR, it'll look off!</p></aside></div></div></section><div class="last-modified">Last modified: 26 June 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="get-started-with-dev-containers.html" class="navigation-links__prev">Get Started with Dev Containers</a><a href="mix-match.html" class="navigation-links__next">MixMatch</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.js"></script></body></html>