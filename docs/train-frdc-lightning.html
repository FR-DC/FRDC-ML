<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-12-11T17:31:22.0207588"><meta name="build-number" content="${buildNumber}">       <title>train.frdc_datamodule &amp; frdc_module | Documentation</title><script id="virtual-toc-data" type="application/json">[{"id":"classes","level":0,"title":"Classes","anchor":"#classes"},{"id":"usage","level":0,"title":"Usage","anchor":"#usage"},{"id":"api","level":0,"title":"API","anchor":"#api"}]</script><script id="topic-shortcuts" type="application/json"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="train.frdc_datamodule &amp; frdc_module | Documentation"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="Documentation Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="/d/0.0.4/train-frdc-lightning.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="train.frdc_datamodule &amp; frdc_module | Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "/d/0.0.4/train-frdc-lightning.html#webpage", "url": "/d/0.0.4/train-frdc-lightning.html", "name": "train.frdc_datamodule &amp; frdc_module | Documentation", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "/d/#website", "url": "/d/", "name": "Documentation Help" }</script><!-- End Schema.org --></head>      <body data-id="train.frdc_lightning" data-main-title="train.frdc_datamodule &amp; frdc_module" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="API"  >   <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Documentation 0.0.4 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="train.frdc_lightning"   id="train.frdc_lightning.md">train.frdc_datamodule &amp; frdc_module</h1> <div class="micro-format" data-content="{&quot;microFormat&quot;:[&quot;\u003cp id\u003d\&quot;2a37c22f_166\&quot;\u003eThe FRDC PyTorch LightningDataModule and LightningModule.\u003c/p\u003e&quot;]}"></div> <p id="2a37c22f_119">These are FRDC specific LightningDataModule and LightningModule, a core component in the PyTorch Lightning ecosystem to provide a simple interface to train and evaluate models.</p><section class="chapter"><h2 id="classes" data-toc="classes"   >Classes</h2><aside class="prompt" data-type="note" data-title="" id="2a37c22f_120"><p id="2a37c22f_121">It's optional to use these classes, you can use your own training loop if you want. We'll use these for our training pipeline.</p></aside><dl id="2a37c22f_122" data-style="title-left" data-title-width="medium"><dt id="2a37c22f_123" data-expandable="false">FRDCDataModule</dt><dd><p><b id="2a37c22f_124">The FRDC PyTorch Lightning DataModule.</b></p></dd><dt id="2a37c22f_125" data-expandable="false">FRDCModule</dt><dd><p><b id="2a37c22f_126">The FRDC PyTorch Lightning Module.</b></p></dd></dl></section><section class="chapter"><h2 id="usage" data-toc="usage"   >Usage</h2><aside class="prompt" data-type="tip" data-title="" id="2a37c22f_127"><p id="2a37c22f_128">See our training pipeline for a full example</p></aside></section><section class="chapter"><h2 id="api" data-toc="api"   >API</h2><dl id="2a37c22f_129" data-style="title-top"><dt id="2a37c22f_130" data-expandable="false">FRDCDataModule(segments, labels, preprocess, augmentation, train_val_test_split, batch_size)</dt><dd><p><b id="2a37c22f_131">Initializes the FRDC PyTorch Lightning DataModule.</b></p><br><ul class="list _ul" id="2a37c22f_133"><li class="list__item" id="2a37c22f_134"><p><code class="code" id="2a37c22f_135">segments</code>, <code class="code" id="2a37c22f_136">labels</code> are retrieved from </p><ul class="list _ul" id="2a37c22f_137"><li class="list__item" id="2a37c22f_138"><p><a href="load-dataset.html#frdcdataset" id="2a37c22f_139" data-tooltip="Initializes the dataset. This doesn't immediately download the dataset, but only when you call the get_* functions. The site, date, version must match the dataset path on GCS. For example if the dataset is at gs://frdc-scan/my-site/20201218/90deg/map, site='my-site' date='20201218'&hellip;"  >FRDCDataset</a></p></li><li class="list__item" id="2a37c22f_140"><p><a href="preprocessing-extract-segments.html" id="2a37c22f_141" data-tooltip="A boundary is a Rect object that represents the minimum bounding box of a segment, with x0, y0, x1, y1 coordinates."  >Segmentation</a></p></li></ul></li><li class="list__item" id="2a37c22f_142"><p><code class="code" id="2a37c22f_143">preprocess</code> is a function that takes in a segment and returns a preprocessed segment. In particular, it should accept a list of NumPy NDArrays and return a single stacked PyToch Tensor.</p></li><li class="list__item" id="2a37c22f_144"><p><code class="code" id="2a37c22f_145">augmentation</code> is a function that takes in a segment and returns an augmented segment. In particular, it takes in a PyTorch Tensor and returns another.</p></li><li class="list__item" id="2a37c22f_146"><p><code class="code" id="2a37c22f_147">train_val_test_split</code> is a function that takes a TensorDataset and returns a list of 3 TensorDatasets, for train, val and test respectively.</p></li><li class="list__item" id="2a37c22f_148"><p><code class="code" id="2a37c22f_149">batch_size</code> is the batch size.</p></li></ul><aside class="prompt" data-type="note" data-title="" id="2a37c22f_150"><p>For now, the <code class="code" id="2a37c22f_151">augmentation</code> is only applied to training data</p></aside></dd><dt id="2a37c22f_152" data-expandable="false">FRDCModule(model_cls, model_kwargs, optim_cls, optim_kwargs)</dt><dd><p><b id="2a37c22f_153">Initializes the FRDC PyTorch Lightning Module.</b></p><br><ul class="list _ul" id="2a37c22f_155"><li class="list__item" id="2a37c22f_156"><p><code class="code" id="2a37c22f_157">model_cls</code> is the Class of the model.</p></li><li class="list__item" id="2a37c22f_158"><p><code class="code" id="2a37c22f_159">model_kwargs</code> is the kwargs to pass to the model.</p></li><li class="list__item" id="2a37c22f_160"><p><code class="code" id="2a37c22f_161">optim_cls</code> is the Class of the optimizer.</p></li><li class="list__item" id="2a37c22f_162"><p><code class="code" id="2a37c22f_163">optim_kwargs</code> is the kwargs to pass to the optimizer.</p></li></ul><p> Internally, the module will initialize the model and optimizer as follows: </p><div class="code-block" data-lang="python"         >
model = model_cls(**model_kwargs)
optim = optim_cls(model.parameters(), **optim_kwargs)
</div><aside class="prompt" data-type="note" data-title="" id="2a37c22f_165"><p>We do not accept the instances of the Model and Optimizer so that we can pickle them.</p></aside></dd></dl></section><div class="last-modified"> Last modified: 11 December 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="preprocessing-glcm-padded.html">preprocessing.glcm_padded</a>   </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.js"></script></body></html>