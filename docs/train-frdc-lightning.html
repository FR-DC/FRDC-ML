<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-12-27T17:28:00.263479">        <title>train.frdc_datamodule &amp; frdc_module | Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"classes","level":0,"title":"Classes","anchor":"#classes"},{"id":"usage","level":0,"title":"Usage","anchor":"#usage"},{"id":"api","level":0,"title":"API","anchor":"#api"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png">  <link rel="manifest" href="site.webmanifest">  <meta name="msapplication-TileColor" content="#000000"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png">  <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="train.frdc_datamodule &amp; frdc_module | Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="/d/0.0.8/train-frdc-lightning.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="train.frdc_datamodule &amp; frdc_module | Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "WebPage", "@id": "/d/0.0.8/train-frdc-lightning.html#webpage", "url": "/d/0.0.8/train-frdc-lightning.html", "name": "train.frdc_datamodule &amp; frdc_module | Documentation", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{ "@type": "WebSite", "@id": "/d/#website", "url": "/d/", "name": "Documentation Help" }</script><!-- End Schema.org --></head>      <body data-id="train.frdc_lightning" data-main-title="train.frdc_datamodule &amp; frdc_module" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="API"  >   <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Documentation 0.0.8 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="train.frdc_lightning"   id="train.frdc_lightning.md">train.frdc_datamodule &amp; frdc_module</h1> <div class="micro-format" data-content="{&quot;microFormat&quot;:[&quot;\u003cp id\u003d\&quot;2fcccc5f_2976\&quot;\u003eThe FRDC PyTorch LightningDataModule and LightningModule.\u003c/p\u003e&quot;]}"></div> <p id="2fcccc5f_2929">These are FRDC specific LightningDataModule and LightningModule, a core component in the PyTorch Lightning ecosystem to provide a simple interface to train and evaluate models.</p><section class="chapter"><h2 id="classes" data-toc="classes">Classes</h2><aside class="prompt" data-type="note" data-title="" id="2fcccc5f_2930"><p id="2fcccc5f_2931">It's optional to use these classes, you can use your own training loop if you want. We'll use these for our training pipeline.</p></aside><dl id="2fcccc5f_2932" data-style="title-left" data-title-width="medium"><dt id="2fcccc5f_2933" data-expandable="false">FRDCDataModule</dt><dd><p><b id="2fcccc5f_2934">The FRDC PyTorch Lightning DataModule.</b></p></dd><dt id="2fcccc5f_2935" data-expandable="false">FRDCModule</dt><dd><p><b id="2fcccc5f_2936">The FRDC PyTorch Lightning Module.</b></p></dd></dl></section><section class="chapter"><h2 id="usage" data-toc="usage">Usage</h2><aside class="prompt" data-type="tip" data-title="" id="2fcccc5f_2937"><p id="2fcccc5f_2938">See our training pipeline for a full example</p></aside></section><section class="chapter"><h2 id="api" data-toc="api">API</h2><dl id="2fcccc5f_2939" data-style="title-top"><dt id="2fcccc5f_2940" data-expandable="false">FRDCDataModule(segments, labels, preprocess, augmentation, train_val_test_split, batch_size)</dt><dd><p><b id="2fcccc5f_2941">Initializes the FRDC PyTorch Lightning DataModule.</b></p><br><ul class="list _ul" id="2fcccc5f_2943"><li class="list__item" id="2fcccc5f_2944"><p><code class="code" id="2fcccc5f_2945">segments</code>, <code class="code" id="2fcccc5f_2946">labels</code> are retrieved from </p><ul class="list _ul" id="2fcccc5f_2947"><li class="list__item" id="2fcccc5f_2948"><p><a href="load-dataset.html" id="2fcccc5f_2949" data-tooltip="You need to Set-Up Google Cloud with the appropriate permissions to use this library.">FRDCDataset</a></p></li><li class="list__item" id="2fcccc5f_2950"><p><a href="preprocessing-extract-segments.html" id="2fcccc5f_2951" data-tooltip="A boundary is a Rect object that represents the minimum bounding box of a segment, with x0, y0, x1, y1 coordinates.">Segmentation</a></p></li></ul></li><li class="list__item" id="2fcccc5f_2952"><p><code class="code" id="2fcccc5f_2953">preprocess</code> is a function that takes in a segment and returns a preprocessed segment. In particular, it should accept a list of NumPy NDArrays and return a single stacked PyToch Tensor.</p></li><li class="list__item" id="2fcccc5f_2954"><p><code class="code" id="2fcccc5f_2955">augmentation</code> is a function that takes in a segment and returns an augmented segment. In particular, it takes in a PyTorch Tensor and returns another.</p></li><li class="list__item" id="2fcccc5f_2956"><p><code class="code" id="2fcccc5f_2957">train_val_test_split</code> is a function that takes a TensorDataset and returns a list of 3 TensorDatasets, for train, val and test respectively.</p></li><li class="list__item" id="2fcccc5f_2958"><p><code class="code" id="2fcccc5f_2959">batch_size</code> is the batch size.</p></li></ul><aside class="prompt" data-type="note" data-title="" id="2fcccc5f_2960"><p>For now, the <code class="code" id="2fcccc5f_2961">augmentation</code> is only applied to training data</p></aside></dd><dt id="2fcccc5f_2962" data-expandable="false">FRDCModule(model_cls, model_kwargs, optim_cls, optim_kwargs)</dt><dd><p><b id="2fcccc5f_2963">Initializes the FRDC PyTorch Lightning Module.</b></p><br><ul class="list _ul" id="2fcccc5f_2965"><li class="list__item" id="2fcccc5f_2966"><p><code class="code" id="2fcccc5f_2967">model_cls</code> is the Class of the model.</p></li><li class="list__item" id="2fcccc5f_2968"><p><code class="code" id="2fcccc5f_2969">model_kwargs</code> is the kwargs to pass to the model.</p></li><li class="list__item" id="2fcccc5f_2970"><p><code class="code" id="2fcccc5f_2971">optim_cls</code> is the Class of the optimizer.</p></li><li class="list__item" id="2fcccc5f_2972"><p><code class="code" id="2fcccc5f_2973">optim_kwargs</code> is the kwargs to pass to the optimizer.</p></li></ul><p> Internally, the module will initialize the model and optimizer as follows: </p><div class="code-block" data-lang="python">
model = model_cls(**model_kwargs)
optim = optim_cls(model.parameters(), **optim_kwargs)
</div><aside class="prompt" data-type="note" data-title="" id="2fcccc5f_2975"><p>We do not accept the instances of the Model and Optimizer so that we can pickle them.</p></aside></dd></dl></section><div class="last-modified">Last modified: 27 December 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"> <a href="preprocessing-glcm-padded.html" class="navigation-links__prev">preprocessing.glcm_padded</a> </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.js"></script></body></html>